#FUNCTION
visualize <- function(file, data, ylim, names, title) {
  measures = c("I&I-STSS", "LinSTSS", "P2Q")
  colors = c("darkgray", "lightgray", rgb(0.5, 0.5, 1))
  pdf(file = file, width=14, height=5)    
    mp <- barplot(data, main=title, beside=TRUE, col=colors, names.arg=names, ylim=ylim)
    legend("topleft", measures, cex=0.9, bty="n", fill=colors);
    text(mp, cbind(data), labels = cbind(round(data*100)), pos = 3)
  dev.off()
}

#TYPE 1
data = matrix(c(
0.14766443436681098, 0.15581622789367597, 0.06,
0.2057261223885123, 0.2057261223885123, 0.16,
0.20419379861101697, 0.21673715235089838, 0.19,
0.11151249721625271, 0.05624968661121696, 0.25
), ncol=4)
ylim <- c(0,0.3)
names =  c("TFIDF, SN", "CE", "Cat1,2,3", "CE, Cat1,2,3")
title <- "Type 1 - Questions"
file <- "mrrType1Questions.pdf"
visualize(file, data, ylim, names, title)

#TYPE 2
data = matrix(c(
0.1522041587002879, 0.15789774567636716, 0.21427734848236252,
0.1701000104217692, 0.18980316368002878, 0.21427734848236252,
0.1750297540424881, 0.049503770620058375, 0.21427734848236252,
0.22, 0.22, 0.21427734848236252
), ncol=4)
ylim <- c(0,0.3)
names = c("SN, TFIDF", "CE", "CE, Cat1,2,3", "Cat1,2,3")
title <- "TYPE 2 - Answers"
file <- "mrrType2Answers.pdf"
visualize(file, data, ylim, names, title)

#TYPE 3
data = matrix(c(0.10988814982830548, 0.06182614881028498, 0.0561902834541046,
0.1023018072733004, 0.10266640354955557, 0.051082623517906614,
0.16429682736365836, 0.19875410351695258, 0.09065697677437144,
0.10406928161185959, 0.05579667088841015, 0.05364425672994612,
0.10929274862285626, 0.05764935860424769, 0.05399485588007421,
0.08717885873534632, 0.09828963869528136, 0.06416119759866096), ncol=6)
ylim <- c(0,0.3)
names = c("CE, SN, TFIDF", "CE", "CE, Cat1,2,3", "TFIDF", "SN, TFIDF", "SN")
title <- "TYPE 3 - Answers"
file <- "mrrType3Answers.pdf"
visualize(file, data, ylim, names, title)

#TYPE 2 THREAD
data = matrix(c(
0.07411366643974013, 0.06929136646917423, 0.06033056770724302,
0.16421185007910627, 0.04086973525540112, 0.04023491199652911,
0.15217736314101657, 0.16695902423003542, 0.03591214148329596,
0.2135165506453131, 0.2135165506453131, 0.03153423381638847,
0.18126501145489932, 0.045042781345931954, 0.04458089292373564,
0.14990960133439407, 0.041496935391466094, 0.04123507932729759,
0.06724336837284885, 0.06851358932683796, 0.04826253800530894  
  ), ncol=7)
ylim <- c(0,0.3)
names = c("SN", "CE, SN, TFIDF", "CE", "Cat1,2,3", "TFIDF", "SN, TFIDF", "SN")
title <- "TYPE 2 - Thread"
file <- "mrrType2Thread.pdf"
visualize(file, data, ylim, names, title)

#TYPE 3 THREAD
data = matrix(c(
0.14059942534999326, 0.038966306107976884, 0.00,
0.11184196062038738, 0.11090789504653015, 0.00,
0.16531042504498988, 0.16531042504498988, 0.15681189818954297,
0.1580806924907317, 0.21460471873406767, 0.00,
0.15536318937886479, 0.044671618606316785, 0.00,
0.13016452452151317, 0.043380424307742825, 0.00,
0.08976825426176371, 0.10906085274560072, 0.00  
  ), ncol=7)
ylim <- c(0,0.3)
names = c("CE, SN, TFIDF", "CE", "Cat1,2,3", "CE, Cat1,2,3", "TFIDF", "SN, TFIDF", "SN")
title <- "TYPE 3 - Thread"
file <- "mrrType3Thread.pdf"
visualize(file, data, ylim, names, title)

